(this.webpackJsonpcontext=this.webpackJsonpcontext||[]).push([[0],{32:function(e,t,a){e.exports=a(48)},47:function(e,t,a){},48:function(e,t,a){"use strict";a.r(t);var n=a(0),o=a.n(n),r=a(11),c=a.n(r),u=a(4),i=a(15),s=a.n(i),l=a(24),d=a(2),h={authError:"",authMessage:"",authData:{},showLoader:!1,showError:!1,successedNotification:!1,isAuthenticated:!1,freshedLogin:!1},b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"AUTH_STARTED":return Object(d.a)(Object(d.a)({},e),{},{showLoader:!0});case"AUTH_REQUEST_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{authData:n.data||{},authMessage:n.message,successedNotification:!0,showLoader:!1});case"AUTH_REQUEST_FAIL":return Object(d.a)(Object(d.a)({},e),{},{authError:n.message,showError:n.showError});case"RESET_LOADERS":if(e.showError)return Object(d.a)(Object(d.a)({},e),{},{showError:n,showLoader:!1});if(e.successedNotification)return Object(d.a)(Object(d.a)({},e),{},{successedNotification:n,showLoader:!1});break;case"REMOVE_LOADER":return Object(d.a)(Object(d.a)({},e),{},{showLoader:!1});case"AUTH_LOGOUT":return{authError:"",authMessage:"",authData:{},showLoader:!1,showError:!1,successedNotification:!1,isAuthenticated:!1};case"CHECKAUTH":return Object(d.a)(Object(d.a)({},e),{},{isAuthenticated:n});case"FRESHEDLOGIN":return Object(d.a)(Object(d.a)({},e),{},{freshedLogin:n});default:return e}},E=a(5),f=function(e){return{type:"ADD_BOOKS",payload:e}},p=function(e){return{type:"REMOVE_BOOKS",payload:e}},m=function(e){return{type:"FETCH_BOOKLIST_SUCCESS",payload:e}},O=function(e){return{type:"SET_INPUT_TITLE",payload:e}},g=function(e){return{type:"GET_SINGLE_BOOKLIST_SUCCESS",payload:e}},j=function(e){return{type:"SET_UPDATE_INPUTS",payload:e}},v=function(e){return{type:"AUTH_REQUEST_SUCCESS",payload:e}},S=function(e){return{type:"AUTH_REQUEST_FAIL",payload:e}},y=function(e){return{type:"CHECKAUTH",payload:e||!1}},T=function(e){return{type:"FRESHEDLOGIN",payload:e||!1}},D=Object(n.createContext)();var k=function(e){var t=function(){var e=Object(n.useReducer)(b,h),t=Object(u.a)(e,2),a=t[0],o=t[1],r=Object(E.g)(),c=Object(n.useCallback)(function(){var e=Object(l.a)(s.a.mark((function e(t){var n,c,u,i,d;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.method,c=t.params,u=void 0===c?{}:c,"SIGNUP"===n&&(i="https://identitytoolkit.googleapis.com/v1/accounts:signUp?key=".concat("AIzaSyDDEeuzfE7OrQR0LieE3D7WWO9-Jqir4JI"),d={email:u.email,password:u.password,displayName:u.displayName},"SIGNIN"===n&&(i="https://identitytoolkit.googleapis.com/v1/accounts:signInWithPassword?key=".concat("AIzaSyDDEeuzfE7OrQR0LieE3D7WWO9-Jqir4JI"),d={email:u.email,password:u.password}),o({type:"AUTH_STARTED"}),fetch(i,{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(d)}).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){o({type:"REMOVE_LOADER"}),"SIGNIN"===n&&(o(v({data:{idToken:e.idToken,localId:e.localId},message:"Login successfull"})),o(y(!0)),o(T(!0)),r.push({pathname:"/booklist",state:a}),setTimeout((function(){o(T(!1))}),5e3)),o(v({message:"user created successfully please login"}))})).catch(function(){var e=Object(l.a)(s.a.mark((function e(t){var a,n;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:a=e.sent,n=a.error.message,o({type:"REMOVE_LOADER"}),o(S({message:n,showError:!0}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),"SIGNIN"===n&&(o({type:"AUTH_STARTED"}),z.auth().signInWithEmailAndPassword(u.email,u.password).then((function(e){o({type:"REMOVE_LOADER"}),o(y(!0)),o(T(!0)),setTimeout((function(){o(T(!1))}),5e3)})).catch((function(e){var t=e.message;o({type:"REMOVE_LOADER"}),o(S({message:t,showError:!0}))}))),e.abrupt("return",(function(){return console.log("PLease wipe the auth function")}));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[a,r]);return[a,c,o]}(),a=Object(u.a)(t,3),r=a[0],c=a[1],i=a[2];return o.a.createElement(D.Provider,{value:{state:r,onAuth:c,dispatch:i}},e.children)},I=a(19),A=a.n(I),_=(a(44),function(){return o.a.createElement("div",null,o.a.createElement("h1",null,"Welcome to the Booklist pro"))}),C=function(){var e=Object(n.useContext)(D),t=e.state,a=e.onAuth,r=Object(n.useState)(""),c=Object(u.a)(r,2),i=c[0],s=c[1],l=Object(n.useState)(""),d=Object(u.a)(l,2),h=d[0],b=d[1],E=Object(n.useState)(!1),f=Object(u.a)(E,2),p=f[0],m=f[1],O=Object(n.useState)(""),g=Object(u.a)(O,2),j=g[0],v=g[1],S=Object(n.useState)(""),y=Object(u.a)(S,2),T=y[0],k=y[1],I=new A.a.auth.GoogleAuthProvider,_=t.showLoader,C=t.showError,w=t.authError,L=t.authMessage,R=t.successedNotification;return o.a.createElement("div",null,o.a.createElement("h3",null,"Login"),_&&o.a.createElement("div",null,"Loading..."),C&&o.a.createElement("div",null,w),R&&o.a.createElement("div",null,L),T,o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i.length>0&&h.length>0&&a({method:"SIGNIN",params:{email:i,password:h}})}},o.a.createElement("input",{type:"email",placeholder:"Email",value:i,onChange:function(e){return s(e.target.value)}}),o.a.createElement("input",{type:"password",placeholder:"Password",value:h,onChange:function(e){return b(e.target.value)}}),o.a.createElement("button",{type:"submit"},"Submit")),o.a.createElement("button",{onClick:function(){z.auth().signInWithPopup(I).then((function(e){})).catch((function(e){console.log(e)}))}},"Login with google"),p&&o.a.createElement("div",null,o.a.createElement("label",null,"Email to reset Password"),o.a.createElement("br",null),o.a.createElement("input",{type:"email",placeholder:"Enter your email",value:j,onChange:function(e){return v(e.target.value)}}),o.a.createElement("button",{onClick:function(){if(j.trim().length>0){z.auth().sendPasswordResetEmail(j,{url:"https://utkarsh4321.github.io/Booklist/#/login",handleCodeInApp:!1}).then((function(e){k("Email send successfully to reset your password"),v(""),setTimeout((function(){k("")}),3e3)})).catch((function(e){return console.log(e)}))}}},"Send")),o.a.createElement("button",{onClick:function(){m(!p)}},"Forget Password"))},w=function(e){var t=Object(n.useContext)(D),a=t.state,r=t.onAuth,c=t.dispatch,i=Object(n.useState)(""),s=Object(u.a)(i,2),l=s[0],d=s[1],h=Object(n.useState)(""),b=Object(u.a)(h,2),E=b[0],f=b[1],p=Object(n.useState)(""),m=Object(u.a)(p,2),O=m[0],g=m[1],j=a.showLoader,v=a.showError,S=a.authError,y=a.authMessage,T=a.successedNotification;return(v||T)&&setTimeout((function(){c({type:"RESET_LOADERS",payload:!1})}),3e3),o.a.createElement("div",null,o.a.createElement("h3",null,"signup"),j&&o.a.createElement("div",null,"Loading..."),v&&o.a.createElement("div",null,S),T&&o.a.createElement("div",null,y),o.a.createElement("form",{onSubmit:function(e){e.preventDefault(),l.length>0&&E.length>0&&(r({method:"SIGNUP",params:{email:l,password:E,displayName:O}}),f(""),d(""),g(""))}},o.a.createElement("input",{type:"text",value:O,placeholder:"Name",onChange:function(e){g(e.target.value)}}),o.a.createElement("input",{type:"email",value:l,placeholder:"Email",onChange:function(e){d(e.target.value)}}),o.a.createElement("input",{type:"password",value:E,placeholder:"Password",onChange:function(e){f(e.target.value)}}),o.a.createElement("button",{type:"submit"},"Submit")))},L=a(20),R={books:[],loader:!1,error:!1,errorMessage:"",booksData:{author:"",title:"",id:""},updatedId:""},N=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:R,t=arguments.length>1?arguments[1]:void 0,a=t.type,n=t.payload;switch(a){case"ADD_BOOKS":return Object(d.a)(Object(d.a)({},e),{},{books:[].concat(Object(L.a)(e.books),[n])});case"REMOVE_BOOKS":return Object(d.a)(Object(d.a)({},e),{},{books:e.books.filter((function(e){return e.id!==n}))});case"FETCH_BOOKLIST_SUCCESS":return Object(d.a)(Object(d.a)({},e),{},{books:n});case"SHOW_LOADER":return Object(d.a)(Object(d.a)({},e),{},{loader:!0});case"REMOVE_LOADER":return Object(d.a)(Object(d.a)({},e),{},{loader:!1});case"SHOW_ERROR":return Object(d.a)(Object(d.a)({},e),{},{error:!0,errorMessage:n});case"HIDE_ERROR":return Object(d.a)(Object(d.a)({},e),{},{error:!1,errorMessage:""});case"SET_INPUT_TITLE":return Object(d.a)(Object(d.a)({},e),{},{booksData:n});case"GET_SINGLE_BOOKLIST_SUCCESS":var o=e.books;return o[n.index]=n,Object(d.a)(Object(d.a)({},e),{},{books:o});case"SET_UPDATE_INPUTS":return Object(d.a)(Object(d.a)({},e),{},{updatedId:n});default:return e}},P=Object(n.createContext)(),U=function(e){var t=function(){var e=Object(n.useReducer)(N,R),t=Object(u.a)(e,2),a=t[0],o=t[1];return[a,Object(n.useCallback)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.method,a=void 0===t?"GET":t,n=e.params,r=void 0===n?{}:n,c=[];if("GET"===a&&fetch('https://booklist-project-32f2a.firebaseio.com/todos.json?orderBy="userId"&equalTo='.concat(localStorage.getItem("userId"))).then((function(e){return e.json()})).then((function(e){e&&Object.entries(e).forEach((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];c[n.index]=Object(d.a)({id:a},n)})),o(m(c))})).catch((function(e){e.message})),"POST"===a&&fetch("https://booklist-project-32f2a.firebaseio.com/todos.json",{method:"POST",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){o(f(Object(d.a)(Object(d.a)({},r),{},{id:e.name})))})).catch((function(e){return console.log(e)})),"DELETE"===a&&fetch("https://booklist-project-32f2a.firebaseio.com/todos.json",{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r.obj)}).then((function(e){return e.json()})).then((function(e){o(p(r.id))})).catch((function(e){return console.log(e)})),"UPDATE"===a&&fetch("https://booklist-project-32f2a.firebaseio.com/todos/".concat(r.id,"/.json"),{method:"PATCH",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r.data)}).then((function(e){return e.json()})).then((function(e){o(g(e)),o(j("")),o(O({id:"",title:"",author:"",index:"",userId:""}))})).catch((function(e){return console.log(e)})),"PUT"===a){var i=[];fetch("https://booklist-project-32f2a.firebaseio.com/todos.json",{method:"PUT",headers:{"Content-Type":"application/json;charset=utf-8"},body:JSON.stringify(r)}).then((function(e){return e.json()})).then((function(e){e&&Object.entries(e).forEach((function(e){var t=Object(u.a)(e,2),a=t[0],n=t[1];i[n.index]=Object(d.a)({id:a},n)})),o(m(i))})).catch((function(e){return console.log(e)}))}return function(){return console.log("Just wipe me out")}}),[]),o]}(),a=Object(u.a)(t,3),r=a[0],c=a[1],i=a[2];return Object(n.useEffect)((function(){return c(),function(){return console.log("Please remove me")}}),[c]),o.a.createElement(P.Provider,{value:{state:r,fetchData:c,dispatch:i}},e.children)},x=a(21);var H=function(e){var t=this,a=Object(n.useContext)(P),r=a.state,c=a.fetchData,i=a.dispatch,s=Object(n.useState)({}),l=Object(u.a)(s,2),h=l[0],b=l[1],E=Object(n.useRef)(null),f=Object(n.useRef)(null);function p(e,t){t.stopPropagation(),b(e),setTimeout((function(){E.current&&E.current.focus()})),i(O(e)),i(j(e.id))}var g=function(e){i(O(Object(d.a)(Object(d.a)({},r.booksData),{},{title:e.target.value})))},v=function(e){i(O(Object(d.a)(Object(d.a)({},r.booksData),{},{author:e.target.value})))},S=function(e){"Enter"===e.key&&f.current.focus()},y=function(e){"Enter"===e.key&&r.booksData.title.length>0&&r.booksData.author.length>0&&(h.title===r.booksData.title&&h.author===r.booksData.author||c({method:"UPDATE",params:{id:r.booksData.id,data:r.booksData}}))};function T(e,t){var a=e.id,n=e.index,o=JSON.parse(JSON.stringify(r.books)).reduce((function(e,t,o){return t.id!==a&&(e[t.id]=t,t.index>n&&(e[t.id].index=o-1)),e}),{});c({method:"DELETE",params:{obj:o,id:a}})}return o.a.createElement("div",{className:"book-list"},r.books.length>0?o.a.createElement(x.a,{onDragEnd:function(e){if(e.destination&&e.destination.index!==e.source.index){var t=function(e,t,a){var n=Array.from(e),o=n.splice(t,1),r=Object(u.a)(o,1)[0];return n.splice(a,0,r),n}(r.books,e.source.index,e.destination.index);i(m(t));for(var a={},n=0;n<=t.length-1;n++)t[n].index=n,a[t[n].id]=t[n];c({method:"PUT",params:a})}}},o.a.createElement(x.c,{droppableId:"droppable"},(function(e,a){return o.a.createElement("ul",Object.assign({},e.droppableProps,{ref:e.innerRef,style:(n=a.isDraggingOver,{background:n?"lightblue":"lightgrey",padding:8,width:250})}),r.books.map((function(e,a){var n=e.id,c=e.title,u=e.author,i=e.userId;return o.a.createElement(x.b,{key:n,draggableId:n,index:a},(function(e,s){return o.a.createElement("li",Object.assign({ref:e.innerRef},e.draggableProps,e.dragHandleProps,{style:(l=s.isDragging,h=e.draggableProps.style,Object(d.a)({userSelect:"none",padding:16,margin:"0 0 ".concat(8,"px 0"),background:l?"lightgreen":"grey"},h))}),o.a.createElement("div",{className:"content"},o.a.createElement("div",{className:"title"},r.updatedId===n&&o.a.createElement("input",{className:"titleInput",type:"text",ref:E,value:r.booksData.title,onChange:g,onKeyDown:S})||c),o.a.createElement("div",{className:"author"},r.updatedId===n&&o.a.createElement("input",{type:"text",ref:f,value:r.booksData.author,onChange:v,onKeyDown:y})||u)),o.a.createElement("button",{onClick:p.bind(t,{id:n,title:c,author:u,index:a,userId:i})},"Update"),o.a.createElement("button",{onClick:T.bind(t,{id:n,index:a}),className:"remove_btn"},"X")," ");var l,h}))})),e.placeholder);var n}))):o.a.createElement("div",null,"No books found"))},J=function(){var e=Object(n.useContext)(P),t=e.state,a=e.fetchData,r=Object(n.useContext)(D).state,c=Object(n.useState)(""),i=Object(u.a)(c,2),s=i[0],l=i[1],d=Object(n.useState)(""),h=Object(u.a)(d,2),b=h[0],E=h[1],f=Object(n.useRef)(null),p=Object(n.useRef)(null),m=Object(n.useRef)(null);Object(n.useEffect)((function(){f.current.focus()}),[t.books]);var O=function(e){e.preventDefault();var n=Object(L.a)(t.books);n.length>0?a({method:"POST",params:{title:s,author:b,index:n.length-1+1,userId:r.authData.localId}}):a({method:"POST",params:{title:s,author:b,index:0,userId:r.authData.localId}}),l(""),E("")};return o.a.createElement("form",{onSubmit:O},o.a.createElement("input",{name:"bookName",placeholder:"Enter book Name ",value:s,ref:f,onChange:function(e){return l(e.target.value)},onKeyDown:function(e){"Enter"===e.key&&p.current.focus()},required:!0}),o.a.createElement("input",{name:"bookAuthor",placeholder:"Enter book Author",ref:p,onChange:function(e){return E(e.target.value)},value:b,onKeyDown:function(e){"Enter"===e.key&&m.current.focus()},required:!0}),o.a.createElement("button",{type:"submit",onKeyDown:function(e){O(e)},ref:m},"Submit"))};var K=function(e){return o.a.createElement(U,null,e.state.freshedLogin&&o.a.createElement("div",null,"Login successfully"),o.a.createElement(J,null),o.a.createElement(H,null))},G=a(31),M=function(e){var t=e.component,a=Object(G.a)(e,["component"]),r=Object(n.useContext)(D).state;return o.a.createElement(E.b,Object.assign({},a,{render:function(e){return r.isAuthenticated&&o.a.createElement(t,Object.assign({},e,{state:r}))||o.a.createElement(E.a,{to:{pathname:"/login"}})}}))},W=a(10);var B=function(e){var t=Object(n.useContext)(D),a=t.state,r=t.dispatch;return o.a.createElement("ul",null,o.a.createElement("li",null,o.a.createElement(W.b,{to:"/"},"Home")),(null===a||void 0===a?void 0:a.isAuthenticated)?null:o.a.createElement("li",null,o.a.createElement(W.b,{to:"login"},"Login")),o.a.createElement("li",null,(null===a||void 0===a?void 0:a.isAuthenticated)?o.a.createElement("button",{type:"button",onClick:function(){r({type:"AUTH_LOGOUT"}),localStorage.removeItem("token"),localStorage.removeItem("userId"),z.auth().signOut().then((function(){})).catch((function(e){console.log(e)}))}},"Logout"):o.a.createElement(W.b,{to:"signup"},"Signup")))},z=A.a.initializeApp({apiKey:"AIzaSyDDEeuzfE7OrQR0LieE3D7WWO9-Jqir4JI",authDomain:Object({NODE_ENV:"production",PUBLIC_URL:"/Booklist",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,REACT_APP_API_KEY:"AIzaSyDDEeuzfE7OrQR0LieE3D7WWO9-Jqir4JI"}).REACT_APP_AUTHDOMAIN});var V=function(){var e=Object(n.useContext)(D).dispatch,t=Object(E.g)(),a=Object(n.useState)(!0),r=Object(u.a)(a,2),c=r[0],i=r[1];return Object(n.useEffect)((function(){return z.auth().onAuthStateChanged((function(a){i(!1),a?(e(y(!0)),localStorage.setItem("userId",JSON.stringify(a.uid)),e(v({data:{localId:JSON.parse(localStorage.getItem("userId"))},message:""})),t.replace("/booklist")):(e({type:"AUTH_LOGOUT"}),localStorage.removeItem("token"),localStorage.removeItem("userId"),t.replace("/login"))})),function(){return console.log("clear it ")}}),[e,t]),o.a.createElement("div",{className:"App"},c&&o.a.createElement("div",null,"Loading...")||o.a.createElement("div",null,o.a.createElement(B,null),o.a.createElement(E.d,null,o.a.createElement(E.b,{path:"/login",component:C}),o.a.createElement(E.b,{path:"/signup",component:w}),o.a.createElement(M,{path:"/booklist",component:K}),o.a.createElement(E.b,{path:"/",exact:!0,component:_}),o.a.createElement(E.a,{to:"/"}))))},Q=(a(47),o.a.createElement(W.a,{basename:"/"},o.a.createElement(k,null,o.a.createElement(V,null))));c.a.render(Q,document.getElementById("root"))}},[[32,1,2]]]);
//# sourceMappingURL=main.674bd322.chunk.js.map